javascript: const tableElement=document.querySelector("#div__body");function captureTableCells(e){const t=e.querySelectorAll("tr"),r=[];return t.forEach((e=>{const t=e.querySelectorAll("td,th"),o=[];t.forEach((e=>{o.push(e)})),r.push(o)})),r}function addNewColumn(e="New Data"){const t=captureTableCells(tableElement),r=t[0].length-1;t.forEach(((t,o)=>{if(t[r]){const l=t[r].cloneNode(!1);l.textContent="",0===o&&(l.textContent=e),t[r].after(l)}}))}let orderInfo,orderArchive={};async function grabXML(e,t,r){let o=await fetch(%60${e}&xml=T%60,{redirect:"follow"});o.redirected&&(o=await fetch(o.url+"&xml=T"));const l=await o.text(),n=(new DOMParser).parseFromString(l,"text/xml");(new XMLSerializer).serializeToString(n);orderInfo=n,orderArchive?.[String(r)]||(orderArchive[String(r)]=orderInfo);return orderInfo.getElementsByTagName(t)[0].textContent}function populateNewColumn(e,t){const r=captureTableCells(tableElement),o=r[0].length-1;r.length;r.forEach(((r,l)=>{const n=r[e];if(r[o]&&n.querySelector("a")&&l>0){const e=r[o];let c=n.querySelector("a").href;const a=c.indexOf("&e=T");if(-1!==a&&(c=c.slice(0,a)),orderArchive?.[String(l)])try{let r=orderArchive[String(l)].getElementsByTagName(t)[0].textContent;e.textContent=r}catch(t){e.textContent="Error"}else grabXML(c,t,l).then((t=>{e.textContent=t})).catch((t=>{e.textContent="Error"}))}}))}function removeColumn(e){const t=captureTableCells(tableElement),r=t[0];let o=-1;e&&(o=r.findIndex((t=>t.textContent.toLowerCase().includes(e.toLowerCase())))),t.forEach(((e,t)=>{const r=e.at(o);r&&r.remove()}))}const afterEl=document.getElementsByClassName("uir-filters")[0],controlDiv=document.createElement("div");controlDiv.style.display="flex",controlDiv.style.flexDirection="column",controlDiv.style.alignItems="flex-end",controlDiv.style.marginBottom="10px",controlDiv.style.marginRight="10px",controlDiv.innerHTML='<table><tr><th>&nbsp;</th><th style="text-align: center">URL column</th><th style="text-align: center">XML tag</th><th style="text-align: center">Header</th><th>&nbsp;</th></tr><tr><td><button id="lesscol" style="width: 24px">-</button></td><td><input id="urlcolumn" type="text" placeholder="URL column" style="width: 80px" /></td><td><input id="xmltag" type="text" placeholder="XML tag" style="width: 80px" /></td><td><input id="header" type="text" placeholder="Header" style="width: 80px" /></td><td><button id="morecol" style="width: 24px">+</button></td></tr></table>',afterEl.after(controlDiv),document.querySelector("#morecol").addEventListener("click",(()=>{preventDefault(),stopPropagation();addNewColumn(document.querySelector("#header").value);populateNewColumn(document.querySelector("#urlcolumn").value-1,document.querySelector("#xmltag").value)})),document.querySelector("#lesscol").addEventListener("click",(()=>{preventDefault(),stopPropagation();removeColumn(document.querySelector("#header").value)}));
